#Велотрекер

##Описание
Простой миниатюрный GPS/ГЛОНАСС-GSM-трекер. Первоначально разрабатывался для велосипеда, однако может быть использован и для автомобиля, **для контроля своих вещей и прочего**. В силу мини-размеров, может быть скрытно установлен - например, под сиденье велосипеда или в задний фонарь.

В устройстве использован чип SIM968, аккумулятор, антенны GSM и GPS и акселерометр.

##Алгоритм охранного трекера
По сигналу от акселерометра устройство пробуждается, начинает запись маршрута и посылает смс-ку на телефон хозяина. Если сел владелец - он не будет отвечать на смс, если ответа нет в течение 5 минут - стереть запись и отключиться. Если принят любой ответ - начать отсылать маршрут на сервер раз в 5 минут.
Также раз в 10 минут подключаемся к серверу, запрашиваем флаг наблюдения (также можно сообщать текущее положение). Если флаг установлен - начинаем отсылать маршрут на сервер раз в 5 минут.

##Алгоритм GPS-логгера
Складываем GPS-трек в память, раз в сутки подключаемся к GSM-сети и сбрасываем накопленную информацию на сервер. В этом случае нужна большая память и не нужен акселерометр, это может быть даже другой версией устройства.

##Список деталей
<table>
	<tr>
		<td><b>Компонент</b></td>
		<td><b>Название</b></td>
		<td><b>Стоимость</b></td>
	</tr>
	<tr>
		<td>GSM/GPS-модуль</td>
		<td>SIM968</td>
		<td>630 руб</td>
	</tr>
	<tr>
		<td>GPS-антенна</td>
		<td></td>
		<td>0 руб</td>
	</tr>
	<tr>
		<td>Плата</td>
		<td></td>
		<td>33 руб</td>
	</tr>
	<tr>
		<td>Батарея</td>
		<td></td>
		<td>230 руб</td>
	</tr>
	<tr>
		<td>USB-гнездо</td>
		<td></td>
		<td>20 руб</td>
	</tr>
	<tr>
		<td>Акселерометр</td>
		<td></td>
		<td>35 руб</td>
	</tr>
	<tr>
		<td>Сборка</td>
		<td></td>
		<td>50 руб</td>
	</tr>
	<tr>
		<td><b>Итого</b></td>
		<td></td>
		<td><b>998 руб</b></td>
	</tr>
</table>

##Лайт-версия
Определять координаты по базовым станциям. Получается не так точно, но отчасти можно это скомпенсировать акселерометром и обработкой на сервере (например, используя карту высот - искать на карте высот похожие точки). В этом случае не нужен GPS, и тратися меньше энергии.

##Различные варианты аккумуляторов
<table>
	<tr>
		<td><b>Название</b></td>
		<td><b>Ёмкость, А*ч</b></td>
		<td><b>Размеры</b></td>
		<td><b>Стоимость, руб</b></td>
		<td><b>Поставщик</b></td>
	</tr>
	<tr>
		<td>LP103450</td>
		<td>1.75</td>
		<td>50*34*11</td>
		<td>254</td>
		<td>Терраэлектроника</td>
	</tr>
	<tr>
		<td>LP103454</td>
		<td>2.00</td>
		<td>54*34*10</td>
		<td>247</td>
		<td>Терраэлектроника</td>
	</tr>
	<tr>
		<td>744272P</td>
		<td>2.50</td>
		<td>72*42*7</td>
		<td></td>
		<td>SzKamcy</td>
	</tr>
	<tr>
		<td>053759P</td>
		<td>1.20</td>
		<td>59*37*5</td>
		<td></td>
		<td>SzKamcy</td>
	</tr>
	<tr>
		<td>LPP 503759 8HH</td>
		<td>1.40</td>
		<td>59*37*5</td>
		<td></td>
		<td>varta-microbattery.com</td>
	</tr>
	<tr>
		<td>LPP 454261 8TH</td>
		<td>1.60</td>
		<td>61*42*5</td>
		<td></td>
		<td>varta-microbattery.com</td>
	</tr>
	<tr>
		<td>564656P</td>
		<td>1.60</td>
		<td>55*46*6</td>
		<td></td>
		<td>hbak-battery.com</td>
	</tr>
	<tr>
		<td>803450P</td>
		<td>1.45</td>
		<td>50*34*8</td>
		<td></td>
		<td>hbak-battery.com</td>
	</tr>
	<tr>
		<td>103450P</td>
		<td>1.80</td>
		<td>50*34*10</td>
		<td></td>
		<td>hbak-battery.com</td>
	</tr>	
</table>

Китайцы: www.szkamcy.com (http://electronix.ru/forum/index.php?showtopic=110801).
www.yokenergy.com (удобный сайт)

##Расчёт времени жизни батареи

Сценарий использования: раз в 10 минут заходим на сервер и общаемся с ним 10 секунд. Во время общения жрём 350мА - 350мАс на сеанс связи = 0.1мАч. За час это произойдёт 6 раз, значит **средний ток GSM-модуля - 0.6мА**. Возможно, стоит подумать над антенной для уменьшения потребляемого тока: здесь (http://electronix.ru/forum/index.php?showtopic=60386&view=findpost&p=647594) говорят о значительном понижении тока при применении НЕсогласованной антенны. Если потребуется делать преобразователь питания - обратить внимание на этот (http://electronix.ru/forum/index.php?showtopic=60386&view=findpost&p=649110) совет.

Потребление основной цифровой части:
0.3мА у акселя + 5мА у МК = 5мА, таким током высосем аккумулятор за 200ч = неделя. Жуть. Надо искать микропотребляющие МК.

На тактовой частоте 1МГц микроконтроллеры потребляют:
<table>
	<tr>
		<td><b>МК</b></td>
		<td><b>Ток, мА</b></td>
	</tr>
	<tr>
		<td>STM32L151x6</td>
		<td>270</td>
	</tr>
	<tr>
		<td>MSP430G2553</td>
		<td>330</td>
	</tr>
	<tr>
		<td>PIC16F1827</td>
		<td>100</td>
	</tr>
</table>
Нельзя напрямую использовать эти цифры, обязательно надо проверить режимы измерения в даташитах.
При использовании STM32L151x6 **ток процессора вместе с акселерометром - 0.6мА**.

**Полное потребление - 1.2мА**. Википедия декларирует саморазряд аккумулятора на уровне 5% в месяц, т.е. разрядный ток 70мкА, его можно не учитывать.
Потратим весь заряд аккумулятора за 35 суток = **месяц**.